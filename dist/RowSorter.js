!function(a,b){"use strict";"function"==typeof define&&define.amd?define("RowSorter",b):"object"==typeof exports?module.exports=b():a.RowSorter=b()}(this,function(){"use strict";function a(c,d){if(!(this instanceof a))return new a(c,d);if("string"==typeof c&&(c=b(c),null===c))throw new Error("Table not found.");p in c&&c[p]instanceof a||(this._options=j(q,d),this._table=c,this._tbody=c,this._rows=[],this._lastY=!1,this._draggingRow=null,this._firstTouch=!0,this._b_mousedown=this._mousedown.bind(this),this._b_mousemove=this._mousemove.bind(this),this._b_mouseup=this._mouseup.bind(this),this._b_touchstart=this._touchstart.bind(this),this._b_touchmove=this._touchmove.bind(this),this._b_touchend=this._touchend.bind(this),this._touchId=null,this._table[p]=this,this.init())}function b(a){var b=k(document,a);return b.length>0&&"nodeName"in b[0]&&"TABLE"===b[0].nodeName?b[0]:null}function c(a,b,c){var d=a.parentNode;1===c?b.nextSibling?d.insertBefore(a,b.nextSibling):d.appendChild(a):-1===c&&d.insertBefore(a,b)}function d(a,b){for(var c=a.rows,d=c.length,e=0;d>e;e++)if(b===c[e])return e;return-1}function e(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)}function f(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)}function g(a,b){if(b=b.trim(),""===b)return!1;if(-1!==b.indexOf(" ")){for(var c=b.split(" "),d=0,e=c.length;e>d;d++)if(0==g(a,c[d]))return!1;return!0}return a.classList?!!a.classList.contains(b):!!a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))}function h(a,b){if(b=b.trim(),""!==b)if(-1===b.indexOf(" "))0==g(a,b)&&(a.classList?a.classList.add(b):a.className+=" "+b);else for(var c=b.split(" "),d=0,e=c.length;e>d;d++)h(a,c[d])}function i(a,b){if(b=b.trim(),""!==b)if(-1===b.indexOf(" ")){if(g(a,b))if(a.classList)a.classList.remove(b);else{var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}}else for(var d=b.split(" "),e=0,f=d.length;f>e;e++)i(a,d[e])}function j(a,b){if(n)return n.extend({},a,b);var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);if(b&&"[object Object]"===Object.prototype.toString.call(b))for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d}function k(a,b){return n?n.makeArray(n(a).find(b)):a.querySelectorAll(b)}function l(a,b){var c=0,d=20,e=a;for(b=b.toLowerCase();e.tagName&&e.tagName.toLowerCase()!==b;){if(c>d||!e.parentNode)return null;e=e.parentNode,c++}return e}function m(a,b){for(var c=0,d=b.length;d>c;c++)if(a===b[c])return c;return-1}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a,b.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(d.prototype=this.prototype),e.prototype=new d,e});var n=window.jQuery||!1,o=!!("ontouchstart"in document),p="data-rowsorter",q={handler:null,tbody:!0,tableClass:"sorting-table",dragClass:"sorting-row",stickTopRows:0,stickBottomRows:0,onDragStart:null,onDrop:null};return a.prototype.init=function(){if(this._options.tbody){var a=this._table.getElementsByTagName("tbody");a.length>0&&(this._tbody=a[0])}if("function"!=typeof this._options.onDragStart&&(this._options.onDragStart=null),"function"!=typeof this._options.onDrop&&(this._options.onDrop=null),("number"!=typeof this._options.stickTopRows||this._options.stickTopRows<0)&&(this._options.stickTopRows=0),("number"!=typeof this._options.stickBottomRows||this._options.stickBottomRows<0)&&(this._options.stickBottomRows=0),e(this._table,"mousedown",this._b_mousedown),e(document,"mouseup",this._b_mouseup),o&&(e(this._table,"touchstart",this._b_touchstart),e(this._table,"touchend",this._b_touchend)),"onselectstart"in document){var b=this;e(document,"selectstart",function(a){var c=a||window.event;return null!==b._draggingRow?(c.preventDefault?c.preventDefault():c.returnValue=!1,!1):void 0})}},a.prototype._mousedown=function(a){var b=a||window.event;return this._start(b.target||b.srcElement,b.clientY)?(b.preventDefault?b.preventDefault():b.returnValue=!1,!1):!0},a.prototype._touchstart=function(a){if(1===a.touches.length){var b=a.touches[0],c=document.elementFromPoint(b.clientX,b.clientY);if(this._touchId=b.identifier,this._start(c,b.clientY))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}return!0},a.prototype._start=function(a,b){if(this._draggingRow&&this._end(),this._rows=this._tbody.rows,this._rows.length<2)return!1;if(this._options.handler){var c=k(this._table,this._options.handler);if(!c||-1===m(a,c))return!1}var f=l(a,"tr"),g=d(this._tbody,f);return-1===g||this._options.stickTopRows>0&&g<this._options.stickTopRows||this._options.stickBottomRows>0&&g>=this._rows.length-this._options.stickBottomRows?!1:(this._draggingRow=f,this._options.tableClass&&h(this._table,this._options.tableClass),this._options.dragClass&&h(this._draggingRow,this._options.dragClass),this._oldIndex=g,this._options.onDragStart&&this._options.onDragStart(this._tbody,this._draggingRow,this._oldIndex),this._lastY=b,e(this._table,"mousemove",this._b_mousemove),o&&e(this._table,"touchmove",this._b_touchmove),!0)},a.prototype._mousemove=function(a){var b=a||window.event;return this._move(b.target||b.srcElement,b.clientY),!0},a.prototype._touchmove=function(a){if(1===a.touches.length){var b=a.touches[0],c=document.elementFromPoint(b.clientX,b.clientY);this._touchId===b.identifier&&this._move(c,b.clientY)}return!0},a.prototype._move=function(a,b){if(this._draggingRow){var e=b>this._lastY?1:b<this._lastY?-1:0;if(0!==e){var f=l(a,"tr");if(f&&f!==this._draggingRow&&-1!==m(f,this._rows)){var g=!0;if(this._options.stickTopRows>0||this._options.stickBottomRows>0){var h=d(this._tbody,f);(this._options.stickTopRows>0&&h<this._options.stickTopRows||this._options.stickBottomRows>0&&h>=this._rows.length-this._options.stickBottomRows)&&(g=!1)}g&&c(this._draggingRow,f,e),this._lastY=b}}}},a.prototype._mouseup=function(a){this._end()},a.prototype._touchend=function(a){a.changedTouches.length>0&&this._touchId===a.changedTouches[0].identifier&&this._end()},a.prototype._end=function(){if(!this._draggingRow)return!0;this._options.tableClass&&i(this._table,this._options.tableClass),this._options.dragClass&&i(this._draggingRow,this._options.dragClass);var a=d(this._tbody,this._draggingRow);this._options.onDrop&&a!==this._oldIndex&&this._options.onDrop(this._tbody,this._draggingRow,a,this._oldIndex),this._draggingRow=null,this._lastY=!1,this._touchId=null,f(this._table,"mousemove",this._b_mousemove),o&&f(this._table,"touchmove",this._b_touchmove)},a.prototype.destroy=function(){this._table[p]=null,f(this._table,"mousedown",this._b_mousedown),f(document,"mouseup",this._b_mouseup),o&&(f(this._table,"touchstart",this._b_touchstart),f(this._table,"touchend",this._b_touchend))},a.destroy=function(c){"string"==typeof c&&(c=b(c)),null!==c&&p in c&&c[p]instanceof a&&c[p].destroy()},n&&(n.fn.extend({rowSorter:function(b){var c=[];return this.each(function(d,e){c.push(new a(e,b))}),1===c.length?c[0]:c}}),n.rowSorter={destroy:a.destroy}),a});